<div data-controller="dropdown" class="w-full relative">
  <!-- Trigger Button -->
  <button type="button" 
          data-action="click->dropdown#toggle click@window->dropdown#hide"
          class="flex items-center gap-2 w-full p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
    <% if avatar_url %>
      <%= image_tag avatar_url, class: "h-6 w-6 rounded-full flex-shrink-0" %>
    <% else %>
      <div class="h-6 w-6 rounded-full bg-blue-600 flex items-center justify-center flex-shrink-0">
        <span class="text-xs font-semibold text-white"><%= user_initials %></span>
      </div>
    <% end %>
    <div class="flex-1 min-w-0 text-left">
      <p class="text-sm font-medium text-gray-900 dark:text-white truncate"><%= display_name %></p>
    </div>
    <svg class="w-4 h-4 text-gray-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
    </svg>
  </button>

  <!-- Dropdown Menu -->
  <div data-dropdown-target="menu"
       class="hidden absolute left-0 top-full mt-2 w-52 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 overflow-hidden z-50">

    <!-- Menu Items -->
    <div class="py-1">
      <% if @profile_path %>
        <%= render ArtisansUi::Dropdown::ItemComponent.new(href: @profile_path, size: :xs) do %>
          <svg class="w-4 h-4 flex-shrink-0 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
          </svg>
          <span>My Profile</span>
        <% end %>
      <% end %>

      <% if @password_path %>
        <%= render ArtisansUi::Dropdown::ItemComponent.new(href: @password_path, size: :xs) do %>
          <svg class="w-4 h-4 flex-shrink-0 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
          </svg>
          <span>Password</span>
        <% end %>
      <% end %>

      <% if @accounts_path %>
        <%= render ArtisansUi::Dropdown::ItemComponent.new(href: @accounts_path, size: :xs) do %>
          <svg class="w-4 h-4 flex-shrink-0 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
          </svg>
          <span>Switch Account</span>
        <% end %>
      <% end %>

      <%= render ArtisansUi::Dropdown::ItemComponent.new(
        href: @logout_path,
        method: :delete,
        destructive: true,
        size: :xs,
        data: { turbo: false }
      ) do %>
        <svg class="w-4 h-4 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
        </svg>
        <span>Log out</span>
      <% end %>
    </div>
  </div>
</div>
